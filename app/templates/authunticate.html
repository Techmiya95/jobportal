{% extends 'base1.html' %}
{% load static %}

{% block head %}
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- FontAwesome Official CDN (for social media icons) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

<!-- Bootstrap JavaScript Bundle (Includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>

<style>
    /* Navbar Styles */
        .navbar {
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 0.8rem 1rem;
        }
        
        .navbar-brand {
            font-weight: 700;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }
        
        .navbar-brand .logo-icon {
            font-size: 1.5rem;
            margin-right: 0.5rem;
            color: #3498db;
        }
        
        .navbar-toggler {
            border: none;
            padding: 0.5rem;
        }
        
        .navbar-toggler:focus {
            outline: none;
            box-shadow: none;
        }
        
        .navbar-toggler-icon {
            background-image: none;
            width: 1.5em;
            height: 1.5em;
            position: relative;
        }
        
        .navbar-toggler-icon::before,
        .navbar-toggler-icon::after {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #2c3e50;
            transition: all 0.3s ease;
        }
        
        .navbar-toggler-icon::before {
            top: 6px;
        }
        
        .navbar-toggler-icon::after {
            bottom: 6px;
        }
        
        .navbar-toggler[aria-expanded="true"] .navbar-toggler-icon::before {
            transform: rotate(45deg);
            top: 10px;
        }
        
        .navbar-toggler[aria-expanded="true"] .navbar-toggler-icon::after {
            transform: rotate(-45deg);
            bottom: 10px;
        }
        
        .nav-link {
            color: #2c3e50;
            font-weight: 500;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover,
        .nav-link:focus {
            color: #3498db;
        }
        
        .profile-icon {
            font-size: 1.1rem;
        }
        
        .btn-outline-light {
            border-color: #3498db;
            color: #3498db;
        }
        
        .btn-outline-light:hover {
            background-color: #3498db;
            color: white;
        }
        
        .btn-light {
            background-color: #3498db;
            color: white;
            border-color: #3498db;
        }
        
        .btn-light:hover {
            background-color: #2980b9;
            border-color: #2980b9;
        }
        
        .btn-danger {
            background-color: #e74c3c;
            border-color: #e74c3c;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
            border-color: #c0392b;
        }
        
        /* Mobile menu styles */
        @media (max-width: 991.98px) {
            .navbar-collapse {
                padding: 1rem;
                background-color: #fff;
                box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
                margin-top: 0.5rem;
                border-radius: 0.25rem;
            }
            
            .nav-item {
                margin-bottom: 0.5rem;
            }
            
            .nav-link {
                padding: 0.5rem 0;
            }
            
            .navbar-nav .btn {
                width: 100%;
                margin-top: 0.5rem;
            }
            
            .d-flex.flex-column.flex-lg-row {
                width: 100%;
            }
        }
        
        /* Desktop menu styles */
        @media (min-width: 992px) {
            .navbar-nav {
                align-items: center;
            }
            
            .nav-item {
                margin-left: 0.5rem;
                margin-right: 0.5rem;
            }
            
            .navbar-nav .btn {
                margin-right: 0.5rem;
            }
          
        }/* Footer */
        footer {
            background-color: #343a40;
            color: white;
            padding: 3rem 0;
            margin-top: auto;
            width: 100%;
        }
        
        .footer-links {
            list-style: none;
            padding: 0;
        }
        
        .footer-links li {
            margin-bottom: 0.5rem;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        .social-icons a {
            color: white;
            font-size: 1.25rem;
            margin-right: 1rem;
            transition: transform 0.3s ease;
        }
        
        .social-icons a:hover {
            transform: translateY(-3px);
        }
    /* Light theme button styling */
    .btn-light-theme {
        background-color: #f8f9fa; /* Light gray background */
        color: #212529; /* Dark text */
        border: 1px solid #ced4da; /* Soft border */
        font-weight: 500;
        transition: background 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px; /* Space between icon and text */
        padding: 10px;
    }

    .btn-light-theme:hover {
        background-color: #e9ecef;
    }

    /* Ensure original logos retain their colors */
    .btn-light-theme i {
        font-size: 18px;
        color: inherit !important; /* Keeps default icon colors */
    }

    /* Google logo original colors */
    .btn-light-theme .fa-google {
        background: linear-gradient(90deg, #4285F4, #34A853, #FBBC05, #EA4335);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    /* Facebook logo original color */
    .btn-light-theme .fa-facebook {
        color: #1877F2 !important;
    }

    /* GitHub logo original color */
    .btn-light-theme .fa-github {
        color: black !important;
    }
    
    /* Validation error styling */
    .is-invalid {
        border-color: #dc3545 !important;
    }
    
    .invalid-feedback {
        color: #dc3545;
        font-size: 0.875em;
        display: none;
        width: 100%;
        margin-top: 0.25rem;
    }
    
    .was-validated .form-control:invalid ~ .invalid-feedback,
    .form-control.is-invalid ~ .invalid-feedback {
        display: block;
    }
    
    /* Password strength indicator */
    .password-strength {
        height: 5px;
        margin-top: 5px;
        background: #e9ecef;
        border-radius: 3px;
        overflow: hidden;
    }
    
    .password-strength-bar {
        height: 100%;
        width: 0%;
        transition: width 0.3s ease, background 0.3s ease;
    }
    
    /* Improved header styling */
    .auth-header {
        text-align: center;
        margin-bottom: 1.5rem;
        position: relative;
    }
    
    .auth-header h3 {
        font-size: 1.75rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 0.5rem;
    }
    
    /* Main container styling */
    .main-container {
        display: flex;
        min-height: 100vh;
        width: 100%;
    }
    
    /* Form container styling */
    .form-container {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 2rem;
        overflow-y: auto;
    }
    
    /* Image container styling */
    .image-container {
        flex: 1;
        background-image: url("{% static 'images/ui.avif' %}");
        background-size: cover;
        background-position: center;
    }
    
    /* Card styling */
    .auth-card {
        width: 100%;
        max-width: 450px;
        border: none;
        border-radius: 12px;
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        padding: 2rem;
    }
    
    /* Responsive adjustments */
    @media (max-width: 992px) {
        .main-container {
            flex-direction: column;
        }
        
        .image-container {
            display: none;
        }
        
        .form-container {
            padding: 1rem;
        }
        
        .auth-card {
            box-shadow: none;
            padding: 1rem;
        }
    }
    
    /* Smooth scrolling for the form */
    html {
        scroll-behavior: smooth;
    }
</style>
{% endblock %}

{% block content %}


<div class="main-container">
    <div class="form-container">
        <div class="auth-card card">
            <!-- Login Form -->
            <form id="loginForm" method="POST" action="{% url 'login' %}" class="needs-validation" novalidate>
                <div class="auth-header">
                    <h3>Sign In</h3>
                </div>
                {% csrf_token %}
                <input type="hidden" name="next" value="{{ request.GET.next|default:'job_list' }}">
                
                <div class="mb-3">
                    <label for="loginUsername" class="form-label">Username or Email</label>
                    <input type="text" class="form-control" id="loginUsername" name="username" 
                           placeholder="Enter Username or Email" 
                           value="{{ username_or_email|default:'' }}"
                           required>
                    <div class="invalid-feedback">
                        Please enter your username or email.
                    </div>
                </div>
                <div class="mb-3">
                    <label for="loginPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="loginPassword" name="password" 
                           placeholder="Password" required>
                    <div class="invalid-feedback">
                        Please enter your password.
                    </div>
                </div>
                <button type="submit" class="btn btn-primary w-100">Continue</button>
                <p class="text-center mt-3">Don't have an account? <a href="#signupForm" id="showSignup">Sign up</a></p>

                {% comment %} <!-- Light-Themed Social Login Buttons -->
                <div class="text-center mt-2">
                    <p class="mb-1">or</p>
                    <a href="" class="btn btn-light-theme w-100 mb-2">
                        <svg fill="none" height="15" viewBox="0 0 16 16" width="15" xmlns="http://www.w3.org/2000/svg"><g><path d="M15.83 8.18C15.83 7.65333 15.7833 7.15333 15.7033 6.66667H8.17V9.67333H12.4833C12.29 10.66 11.7233 11.4933 10.8833 12.06V14.06H13.4567C14.9633 12.6667 15.83 10.6133 15.83 8.18Z" fill="#4285F4"></path><path d="M8.17 16C10.33 16 12.1367 15.28 13.4567 14.06L10.8833 12.06C10.1633 12.54 9.25 12.8333 8.17 12.8333C6.08334 12.8333 4.31667 11.4267 3.68334 9.52667H1.03V11.5867C2.34334 14.2 5.04334 16 8.17 16Z" fill="#34A853"></path><path d="M3.68334 9.52667C3.51667 9.04667 3.43 8.53333 3.43 8C3.43 7.46667 3.52334 6.95334 3.68334 6.47334V4.41334H1.03C0.483335 5.49334 0.170002 6.70667 0.170002 8C0.170002 9.29333 0.483335 10.5067 1.03 11.5867L3.68334 9.52667Z" fill="#FBBC05"></path><path d="M8.17 3.16667C9.35 3.16667 10.4033 3.57334 11.2367 4.36667L13.5167 2.08667C12.1367 0.793334 10.33 0 8.17 0C5.04334 0 2.34334 1.8 1.03 4.41334L3.68334 6.47334C4.31667 4.57334 6.08334 3.16667 8.17 3.16667Z" fill="#EA4335"></path></g></svg> Continue with Google
                    </a>
                    <a href="" class="btn btn-light-theme w-100 mb-2">
                        <i class="fa-brands fa-facebook"></i> Continue with Facebook
                    </a>
                    <a href="" class="btn btn-light-theme w-100 mb-2">
                        <i class="fa-brands fa-github"></i> Continue with GitHub
                    </a>
                </div> {% endcomment %}
               
            </form>

            <!-- Signup Form (Initially Hidden) -->
            <form id="signupForm" method="POST" action="{% url 'signup' %}" style="display: none;" class="needs-validation" novalidate>
                <div class="auth-header">
                    <h3>Sign Up</h3>
                </div>
                {% csrf_token %}
                <div class="mb-3">
                    <label for="signupUsername" class="form-label">Username</label>
                    <input type="text" class="form-control" id="signupUsername" name="username" 
                           placeholder="Enter your username" 
                           pattern="^[a-zA-Z0-9]{4,12}$"
                           required
                           value="{{ form_data.username|default:'' }}">
                    <div class="invalid-feedback">
                        Username must be 4-12 characters (letters and numbers only).
                    </div>
                </div>
                <div class="mb-3">
                    <label for="signupEmail" class="form-label">Email</label>
                    <input type="email" class="form-control" id="signupEmail" name="email" 
                           placeholder="Enter email" 
                           pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
                           required
                           value="{{ form_data.email|default:'' }}">
                    <div class="invalid-feedback">
                        Please enter a valid email address.
                    </div>
                </div>
                <div class="mb-3">
                    <label for="signupPhone" class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="signupPhone" name="phone_number" 
                           placeholder="Enter phone number" 
                           pattern="^[0-9]{10,15}$"
                           required
                           value="{{ form_data.phone_number|default:'' }}">
                    <div class="invalid-feedback">
                        Please enter a valid phone number (10-15 digits).
                    </div>
                </div>
                <div class="mb-3">
                    <label for="signupPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="signupPassword" name="password" 
                           placeholder="Create a password" 
                           pattern="^(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&]).{8,12}$"
                           required>
                    <div class="invalid-feedback">
                        Password must be 8-12 characters with at least one uppercase letter, one number, and one special character.
                    </div>
                    <div class="password-strength mt-2">
                        <div class="password-strength-bar" id="passwordStrengthBar"></div>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="signupConfirmPassword" class="form-label">Confirm Password</label>
                    <input type="password" class="form-control" id="signupConfirmPassword" name="confirm_password" 
                           placeholder="Confirm your password" 
                           required>
                    <div class="invalid-feedback" id="confirmPasswordFeedback">
                        Passwords must match.
                    </div>
                </div>
                <button type="submit" class="btn btn-primary w-100">Continue</button>
                <p class="text-center mt-3">Already have an account? <a href="#loginForm" id="showLogin">Login</a></p>

                <!-- Light-Themed Social Signup Buttons -->
                {% comment %} <div class="text-center mt-2">
                    <p class="mb-1">or</p>
                    <a href="" class="btn btn-light-theme w-100 mb-2">
                        <svg fill="none" height="15" viewBox="0 0 16 16" width="15" xmlns="http://www.w3.org/2000/svg"><g><path d="M15.83 8.18C15.83 7.65333 15.7833 7.15333 15.7033 6.66667H8.17V9.67333H12.4833C12.29 10.66 11.7233 11.4933 10.8833 12.06V14.06H13.4567C14.9633 12.6667 15.83 10.6133 15.83 8.18Z" fill="#4285F4"></path><path d="M8.17 16C10.33 16 12.1367 15.28 13.4567 14.06L10.8833 12.06C10.1633 12.54 9.25 12.8333 8.17 12.8333C6.08334 12.8333 4.31667 11.4267 3.68334 9.52667H1.03V11.5867C2.34334 14.2 5.04334 16 8.17 16Z" fill="#34A853"></path><path d="M3.68334 9.52667C3.51667 9.04667 3.43 8.53333 3.43 8C3.43 7.46667 3.52334 6.95334 3.68334 6.47334V4.41334H1.03C0.483335 5.49334 0.170002 6.70667 0.170002 8C0.170002 9.29333 0.483335 10.5067 1.03 11.5867L3.68334 9.52667Z" fill="#FBBC05"></path><path d="M8.17 3.16667C9.35 3.16667 10.4033 3.57334 11.2367 4.36667L13.5167 2.08667C12.1367 0.793334 10.33 0 8.17 0C5.04334 0 2.34334 1.8 1.03 4.41334L3.68334 6.47334C4.31667 4.57334 6.08334 3.16667 8.17 3.16667Z" fill="#EA4335"></path></g></svg>
                        Sign up with Google
                    </a>
                    <a href="" class="btn btn-light-theme w-100 mb-2">
                        <i class="fa-brands fa-facebook"></i> Sign up with Facebook
                    </a>
                    <a href="" class="btn btn-light-theme w-100 mb-2">
                        <i class="fa-brands fa-github"></i> Sign up with GitHub
                    </a>
                </div> {% endcomment %}
            </form>
        </div>
    </div>
    
    <!-- Image Section -->
    <div class="image-container"></div>
</div>

<!-- Modal for Errors -->
<div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="errorModalLabel">Error</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                {{ error_message }}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
  {% block scripts %}
<!-- Show Modal if Error Exists -->
{% if error_message %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var errorModal = new bootstrap.Modal(document.getElementById('errorModal'));
        errorModal.show();
        document.getElementById('errorModal').addEventListener('hidden.bs.modal', function () {
            window.location.href = "/";
        });
    });
</script>
{% endif %}

{% block extra_scripts %}
<script>
    // Toggle between login and signup forms
    document.getElementById("showSignup").addEventListener("click", function(e) {
        e.preventDefault();
        document.getElementById("loginForm").style.display = "none";
        document.getElementById("signupForm").style.display = "block";
        window.scrollTo(0, 0);
    });

    document.getElementById("showLogin").addEventListener("click", function(e) {
        e.preventDefault();
        document.getElementById("signupForm").style.display = "none";
        document.getElementById("loginForm").style.display = "block";
        window.scrollTo(0, 0);
    });

    // Form validation
    (function () {
        'use strict'
        
        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.querySelectorAll('.needs-validation')
        
        // Loop over them and prevent submission
        Array.prototype.slice.call(forms)
            .forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    
                    form.classList.add('was-validated')
                }, false)
            })
    })();

    // Password confirmation validation
    document.getElementById('signupPassword').addEventListener('input', validatePassword);
    document.getElementById('signupConfirmPassword').addEventListener('input', validatePassword);

    function validatePassword() {
        const password = document.getElementById('signupPassword');
        const confirm = document.getElementById('signupConfirmPassword');
        const feedback = document.getElementById('confirmPasswordFeedback');
        
        if (password.value !== confirm.value) {
            confirm.setCustomValidity("Passwords don't match");
            confirm.classList.add('is-invalid');
            feedback.style.display = 'block';
        } else {
            confirm.setCustomValidity('');
            confirm.classList.remove('is-invalid');
            feedback.style.display = 'none';
        }
    }

    // Password strength indicator
    document.getElementById('signupPassword').addEventListener('input', function() {
        const password = this.value;
        const strengthBar = document.getElementById('passwordStrengthBar');
        let strength = 0;
        
        // Check for length
        if (password.length >= 8) strength += 25;
        if (password.length >= 10) strength += 10;
        
        // Check for uppercase letters
        if (/[A-Z]/.test(password)) strength += 25;
        
        // Check for numbers
        if (/[0-9]/.test(password)) strength += 25;
        
        // Check for special characters
        if (/[@$!%*?&]/.test(password)) strength += 25;
        
        // Update the strength bar
        strengthBar.style.width = strength + '%';
        
        // Change color based on strength
        if (strength < 50) {
            strengthBar.style.backgroundColor = '#dc3545'; // Red
        } else if (strength < 75) {
            strengthBar.style.backgroundColor = '#ffc107'; // Yellow
        } else {
            strengthBar.style.backgroundColor = '#28a745'; // Green
        }
    });
</script>
{% endblock %}
{% endblock %}